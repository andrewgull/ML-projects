ggplot(df, aes(age, bmi)) +
geom_point(aes(color=stroke), alpha = 0.8, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(cols = vars(stroke)) +
guides(legend="none")
?guides
ggplot(df, aes(age, bmi)) +
geom_point(aes(color=stroke), alpha = 0.8, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(cols = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color=stroke), alpha = 0.8, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color=stroke), alpha = 0.8, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color=stroke), alpha = 0.8, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color=stroke), alpha = 0.8, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color=stroke), alpha = 0.8, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = stroke, size = avg_glucose_level), alpha = 0.8) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, cache = T)
library(tidyverse)
library(caret)
#library(GGally)
library(DMwR) # installed via archive: install.packages("/Path/to/DMwR_0.4.1.tar.gz", repos=NULL, type="source" )
library(ROCR)
THREADS <- 16
df <- read_csv("data/healthcare-dataset-stroke-data.csv", col_types = "cfdfffffddcf", na = c("Unknown", "N/A"))
# if you set smoking_status to factor in col_types, na() won't work
df$smoking_status <- as_factor(df$smoking_status)
df$smoking_status <- fct_relevel(df$smoking_status, c("never smoked", "formerly smoked", "smokes"))
df$stroke <- factor(ifelse(df$stroke == 1, "yes", "no"), levels = c("no", "yes"))
df
df$id <- NULL
skimr::skim_to_wide(df)
df %>% group_by(stroke, smoking_status) %>% summarise(N=n())
df %>% filter(is.na(bmi)) %>% group_by(stroke) %>% summarise(N=n())
df <- df %>% filter(gender != "Other")
ggplot(df, aes(stroke, age)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
ggplot(df, aes(stroke, age)) +
geom_violin(alpha=0.3) +
geom_jitter(alpha=0.2, size=0.8, width = 0.15, height = 0.1, aes(color = gender)) +
geom_boxplot(alpha = 0.2) +
scale_color_brewer(palette = "Set2", direction = -1)
ggplot(df, aes(stroke, bmi)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = stroke, size = avg_glucose_level), alpha = 0.2) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = stroke, size = avg_glucose_level), alpha = 0.4) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = avg_glucose_level), alpha = 0.4) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = avg_glucose_level), alpha = 0.4) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "bottom")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = avg_glucose_level), alpha = 0.4) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = avg_glucose_level), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = stroke), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = stroke), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = gender), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = hypertension), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = hypertension), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = gender), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = heart_disease), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = ever_married), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = residence_type), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = Residence_type), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = smoking_status), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = bmi), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = bmi), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = smoking_status), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = smoking_status), alpha = 0.6, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, cache = T)
library(tidyverse)
library(caret)
#library(GGally)
library(DMwR) # installed via archive: install.packages("/Path/to/DMwR_0.4.1.tar.gz", repos=NULL, type="source" )
library(ROCR)
THREADS <- 16
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = smoking_status), alpha = 0.6, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, cache = T)
library(tidyverse)
library(caret)
#library(GGally)
library(DMwR) # installed via archive: install.packages("/Path/to/DMwR_0.4.1.tar.gz", repos=NULL, type="source" )
library(ROCR)
THREADS <- 16
df <- read_csv("data/healthcare-dataset-stroke-data.csv", col_types = "cfdfffffddcf", na = c("Unknown", "N/A"))
# if you set smoking_status to factor in col_types, na() won't work
df$smoking_status <- as_factor(df$smoking_status)
df$smoking_status <- fct_relevel(df$smoking_status, c("never smoked", "formerly smoked", "smokes"))
df$stroke <- factor(ifelse(df$stroke == 1, "yes", "no"), levels = c("no", "yes"))
df
df$id <- NULL
skimr::skim_to_wide(df)
df %>% group_by(stroke, smoking_status) %>% summarise(N=n())
df %>% filter(is.na(bmi)) %>% group_by(stroke) %>% summarise(N=n())
df <- df %>% filter(gender != "Other")
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, cache = T)
library(tidyverse)
library(caret)
#library(GGally)
library(DMwR) # installed via archive: install.packages("/Path/to/DMwR_0.4.1.tar.gz", repos=NULL, type="source" )
library(ROCR)
THREADS <- 16
df <- read_csv("data/healthcare-dataset-stroke-data.csv", col_types = "cfdfffffddcf", na = c("Unknown", "N/A"))
# if you set smoking_status to factor in col_types, na() won't work
df$smoking_status <- as_factor(df$smoking_status)
df$smoking_status <- fct_relevel(df$smoking_status, c("never smoked", "formerly smoked", "smokes"))
df$stroke <- factor(ifelse(df$stroke == 1, "yes", "no"), levels = c("no", "yes"))
df
df$id <- NULL
skimr::skim_to_wide(df)
df %>% group_by(stroke, smoking_status) %>% summarise(N=n())
df %>% filter(is.na(bmi)) %>% group_by(stroke) %>% summarise(N=n())
df <- df %>% filter(gender != "Other")
ggplot(df, aes(stroke, age)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
ggplot(df, aes(stroke, age)) +
geom_violin(alpha=0.3) +
geom_jitter(alpha=0.2, size=0.8, width = 0.15, height = 0.1, aes(color = gender)) +
geom_boxplot(alpha = 0.2) +
scale_color_brewer(palette = "Set2", direction = -1)
ggplot(df, aes(stroke, bmi)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = avg_glucose_level), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = stroke), alpha = 0.4, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, bmi)) +
geom_point(aes(color = stroke), alpha = 0.8, size = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(age, avg_glucose_level)) +
geom_point(aes(color = smoking_status), alpha = 0.6, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
gender <- df %>% group_by(stroke, gender) %>% summarize(N=n())
ggplot(gender, aes(stroke, N)) +
geom_bar(aes(fill=gender), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = -1) +
ylab("proportion")
hyptens <- df %>% group_by(stroke, hypertension) %>% summarize(N=n())
hyptens
ggplot(hyptens, aes(stroke, N)) +
geom_bar(aes(fill=hypertension), alpha = 0.8, stat = "identity", position = "fill")+
scale_fill_brewer(palette = "Set2", direction = -1)+
ylab("proportion")
ggplot(df, aes(stroke, avg_glucose_level)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
ggplot(df, aes(bmi, avg_glucose_level)) +
geom_point(aes(color = age), alpha = 0.6, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(bmi, avg_glucose_level)) +
geom_point(aes(color = age), alpha = 0.6, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides(color = "none")
ggplot(df, aes(bmi, avg_glucose_level)) +
geom_point(aes(color = age), alpha = 0.6, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(stroke, avg_glucose_level)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
hyptens <- df %>% group_by(stroke, hypertension) %>% summarize(N=n())
ggplot(hyptens, aes(stroke, N)) +
geom_bar(aes(fill=hypertension), alpha = 0.8, stat = "identity", position = "fill")+
scale_fill_brewer(palette = "Set2", direction = -1)+
ylab("proportion")
heart <- df %>% group_by(stroke, heart_disease) %>% summarize(N=n())
ggplot(hyeart, aes(stroke, N)) +
geom_bar(aes(fill = heart_disease), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = -1) +
ylab("proportion")
heart <- df %>% group_by(stroke, heart_disease) %>% summarize(N=n())
ggplot(heart, aes(stroke, N)) +
geom_bar(aes(fill = heart_disease), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = -1) +
ylab("proportion")
heart <- df %>% group_by(stroke, heart_disease) %>% summarize(N=n())
ggplot(heart, aes(stroke, N)) +
geom_bar(aes(fill = heart_disease), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
married <- df %>% group_by(stroke, ever_married) %>% summarize(N=n())
ggplot(heart, aes(stroke, N)) +
geom_bar(aes(fill = ever_married), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
married <- df %>% group_by(stroke, ever_married) %>% summarize(N=n())
ggplot(heart, aes(stroke, N)) +
geom_bar(aes(fill = ever_married), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
married
married <- df %>% group_by(stroke, ever_married) %>% summarize(N=n())
ggplot(married, aes(stroke, N)) +
geom_bar(aes(fill = ever_married), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
work <- df %>% group_by(stroke, work_type) %>% summarize(N=n())
ggplot(work, aes(stroke, N)) +
geom_bar(aes(fill = work_type), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
residence <- df %>% group_by(stroke, Residence_type) %>% summarize(N=n())
ggplot(residence, aes(stroke, N)) +
geom_bar(aes(fill = Residence_type), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
smoking <- df %>% group_by(stroke, smoking_status) %>% summarize(N=n())
ggplot(smoking, aes(stroke, N)) +
geom_bar(aes(fill = smoking_status), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
ggplot(df, aes(avg_glucose_level, bmi)) +
geom_point(aes(color = age), alpha = 0.6, size = 1) +
scale_fill_brewer(palette = "Set1", direction = -1) +
facet_grid(rows = vars(stroke)) +
guides()
ggplot(df, aes(smoking_status, age)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
ggplot(df, aes(smoking_status, age)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
df_trim <- df %>% filter(bmi < 60, age > 20 )
skimr::skim(df_trim)
ggplot(df_trim, aes(stroke, bmi)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
ggplot(df_trim, aes(stroke, age)) +
geom_boxplot(aes(fill = stroke), alpha = 0.5, varwidth = T, notch = T) +
geom_violin(aes(fill = stroke), alpha = 0.5) +
scale_fill_brewer(palette = "Set1", direction = -1) +
xlab("")
df$id <- NULL
skimr::skim(df)
df$ever_married <- ifelse(df$ever_married == "Yes", 1, 0)
df$id <- NULL
skimr::skim(df)
df$ever_married <- as.factor(df$ever_married, levels = c(0, 1))
df$ever_married <- as.factor(df$ever_married)
df$id <- NULL
skimr::skim(df)
df <- read_csv("data/healthcare-dataset-stroke-data.csv", col_types = "cfdfffffddcf", na = c("Unknown", "N/A"))
# if you set smoking_status to factor in col_types, na() won't work
df$smoking_status <- as_factor(df$smoking_status)
df$smoking_status <- fct_relevel(df$smoking_status, c("never smoked", "formerly smoked", "smokes"))
# married
df$ever_married <- if_else(ever_married == "Yes", 1, 0)
df %>% if_else(ever_married == "Yes", 1, 0)
if_else(dfever_married == "Yes", 1, 0)
if_else(df$ever_married == "Yes", 1, 0)
# married
df$ever_married <- if_else(df$ever_married == "Yes", 1, 0)
# for models working properly
df$stroke <- factor(ifelse(df$stroke == 1, "yes", "no"), levels = c("no", "yes"))
df
df <- read_csv("data/healthcare-dataset-stroke-data.csv", col_types = "cfdfffffddcf", na = c("Unknown", "N/A"))
# if you set smoking_status to factor in col_types, na() won't work
df$smoking_status <- as_factor(df$smoking_status)
df$smoking_status <- fct_relevel(df$smoking_status, c("never smoked", "formerly smoked", "smokes"))
# married
df$ever_married <- factor(if_else(df$ever_married == "Yes", 1, 0))
# for models working properly
df$stroke <- factor(ifelse(df$stroke == 1, "yes", "no"), levels = c("no", "yes"))
df
df$id <- NULL
skimr::skim(df)
married <- df %>% group_by(stroke, ever_married) %>% summarize(N=n())
ggplot(married, aes(stroke, N)) +
geom_bar(aes(fill = ever_married), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = 1) +
ylab("proportion")
married <- df %>% group_by(stroke, ever_married) %>% summarize(N=n())
ggplot(married, aes(stroke, N)) +
geom_bar(aes(fill = ever_married), alpha = 0.8, stat = "identity", position = "fill") +
scale_fill_brewer(palette = "Set2", direction = -1) +
ylab("proportion")
df_trim <- df %>% filter(bmi < 60, age > 20 )
skimr::skim(df_trim)
install.packages("mice")
library(mice)
imp_mice <- mice(df_trim)
df_imp <- complete(imp_mice)
bmi_imp_comp <- bind_rows(select(df, bmi, stroke) %>% mutate(type = rep("original", nrow(df))),
select(df_imp, bmi, stroke) %>% mutate(type = rep("imputed", nrow(df_imp))))
ggplot(bmi_imp_comp, aes(bmi)) +
geom_histogram(aes(fill=type), alpha=0.8) +
facet_grid(cols = vars(stroke))
bmi_imp_comp <- bind_rows(select(df_trim, bmi, stroke) %>% mutate(type = rep("original", nrow(df_trim))),
select(df_imp, bmi, stroke) %>% mutate(type = rep("imputed", nrow(df_imp))))
ggplot(bmi_imp_comp, aes(bmi)) +
geom_histogram(aes(fill = type), alpha = 0.8) +
facet_grid(cols = vars(stroke))
df_trim <- df %>% filter(bmi < 60, age > 20 )
skimr::skim(df_trim)
library(mice)
imp_mice <- mice(df_trim)
df_imp <- complete(imp_mice)
bmi_imp_comp <- bind_rows(select(df_trim, bmi, stroke) %>% mutate(type = rep("original", nrow(df_trim))),
select(df_imp, bmi, stroke) %>% mutate(type = rep("imputed", nrow(df_imp))))
ggplot(bmi_imp_comp, aes(bmi)) +
geom_histogram(aes(fill = type), alpha = 0.8) +
facet_grid(cols = vars(stroke))
smoke_imp_comp <- bind_rows(select(df, smoking_status, stroke) %>% mutate(type = rep("original", nrow(df))),
select(df_imp, smoking_status, stroke) %>% mutate(type = rep("imputed", nrow(df_imp))))
ggplot(smoke_imp_comp, aes(smoking_status)) +
geom_bar(aes(fill=type), alpha=0.8, position="dodge") +
facet_grid(cols = vars(stroke)) +
xlab("")+
theme(axis.text.x = element_text(angle=45, vjust = 0.5))
# use caret::preProcess()
# preProcValues <- preProcess(training, method = c("center", "scale"))
df_scaled <- df_imp %>%
select(avg_glucose_level, age, bmi) %>%
scale() %>%
data.frame()
# select vars
to_dum <- df_imp %>% select(gender, work_type, Residence_type, smoking_status)
# make an obj
dummies <- dummyVars(~ ., data=to_dum)
# apply it
df_dummy <- data.frame(predict(dummies, newdata=to_dum))
head(df_dummy)
df <- df %>% filter(gender != "Other")
df_trim <- df %>% filter(bmi < 60, age > 20 )
skimr::skim(df_trim)
library(mice)
imp_mice <- mice(df_trim)
df_imp <- complete(imp_mice)
bmi_imp_comp <- bind_rows(select(df_trim, bmi, stroke) %>% mutate(type = rep("original", nrow(df_trim))),
select(df_imp, bmi, stroke) %>% mutate(type = rep("imputed", nrow(df_imp))))
ggplot(bmi_imp_comp, aes(bmi)) +
geom_histogram(aes(fill = type), alpha = 0.8) +
facet_grid(cols = vars(stroke))
smoke_imp_comp <- bind_rows(select(df, smoking_status, stroke) %>% mutate(type = rep("original", nrow(df))),
select(df_imp, smoking_status, stroke) %>% mutate(type = rep("imputed", nrow(df_imp))))
ggplot(smoke_imp_comp, aes(smoking_status)) +
geom_bar(aes(fill=type), alpha=0.8, position="dodge") +
facet_grid(cols = vars(stroke)) +
xlab("")+
theme(axis.text.x = element_text(angle=45, vjust = 0.5))
smoke_imp_comp <- bind_rows(select(df_trim, smoking_status, stroke) %>% mutate(type = rep("original", nrow(df_trim))),
select(df_imp, smoking_status, stroke) %>% mutate(type = rep("imputed", nrow(df_imp))))
ggplot(smoke_imp_comp, aes(smoking_status)) +
geom_bar(aes(fill=type), alpha=0.8, position="dodge") +
facet_grid(cols = vars(stroke)) +
xlab("")+
theme(axis.text.x = element_text(angle=45, vjust = 0.5))
# use caret::preProcess()
# preProcValues <- preProcess(training, method = c("center", "scale"))
df_scaled <- df_imp %>%
select(avg_glucose_level, age, bmi) %>%
scale() %>%
data.frame()
# select vars
to_dum <- df_imp %>% select(gender, work_type, Residence_type, smoking_status)
# make an obj
dummies <- dummyVars(~ ., data=to_dum)
# apply it
df_dummy <- data.frame(predict(dummies, newdata=to_dum))
head(df_dummy)
df_proc <- bind_cols(df_scaled, df_dummy, select(df_trim, hypertension, heart_disease, ever_married, stroke))
head(df_proc)
set.seed(1234)
sample_set <- createDataPartition(y = df_proc$stroke, p = .75, list = FALSE)
df_train <- df_proc[sample_set,]
df_test <- df_proc[-sample_set,]
# DMwR::SMOTE for imbalanced data: over=225 and under=150 give me 1:1 ratio
df_train_smote <- SMOTE(stroke ~ ., data.frame(df_train), perc.over = 1725, perc.under = 106)
df_train_smote %>% group_by(stroke) %>% summarise(N=n())
